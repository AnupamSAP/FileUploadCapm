sap.ui.define(["sap/ui/core/mvc/Controller"],function(e){"use strict";return e.extend("nmpspc.attachfileui.controller.attachfiles",{onInit:function(){this.readAttachmentData()},getBaseURL:function(){var e=this.getOwnerComponent().getManifestEntry("/sap.app/id").replaceAll(".","/");return jQuery.sap.getModulePath(e)},onFileChange:function(e){var t=e.getParameters("files").files[0];this.file=t},onUploadFile:function(){var e=this.byId("__fileUploader");var t=new FileReader;t.onload=function(e){this.content=e.currentTarget.result;this.createfile()}.bind(this);t.readAsDataURL(this.file)},createfile:function(){var e=this;var t={content:this.content,mediaType:this.file.type,fileName:this.file.name};var a=this.getOwnerComponent().getModel("oCAPModel");var i="/MediaFile";a.create(i,t,{success:function(e,t){var a=e.id;var i="File Uploaded Successfully for ID: "+a;MessageBox.success(i)},error:function(e,t){}})},onBeforeUploadStarts:function(e){var t=e.getSource();var a=this;var i=this.getView().byId("UploadSet").getDefaultFileUploader().oFileUpload.files[0];a.fileName=i.name;var n=this.getBaseURL();t.removeAllHeaderFields();t.addHeaderField(new sap.ui.core.Item({key:"sendXHR",text:"true"}));t.addHeaderField(new sap.ui.core.Item({key:"Slug",text:i.name}));t.addHeaderField(new sap.ui.core.Item({key:"Content-Type",text:i.type}));t.setUploadUrl("/v2/media/MediaFile");t.setHttpRequestMethod("POST")},readAttachmentData:function(){var e=this.getOwnerComponent().getModel("oCAPModel");var t="/MediaFile";e.read(t,{success:function(e,t){},error:function(e,t){}})}})});